---
title: "Rshiny"
output: html_document
date: "2024-08-09"
---


library(shiny)
library(ggplot2)
library(dplyr)

ui <- fluidPage(
  titlePanel("Loan Data Dashboard"),
  sidebarLayout(
    sidebarPanel(
      selectInput("variable", "Choose a Variable:", 
                  choices = c("Income", "Loan Amount", "Interest Rate")),
      sliderInput("age_range", "Age Range:",
                  min = min(loan_data$person_age), max = max(loan_data$person_age),
                  value = c(min(loan_data$person_age), max(loan_data$person_age)))
    ),
    mainPanel(
      tabsetPanel(
        tabPanel("Loan Status", plotOutput("loan_status_plot")),
        tabPanel("Income vs Loan Amount", plotOutput("income_loan_plot")),
        tabPanel("Loan Amount Distribution", plotOutput("loan_amount_distribution")),
        tabPanel("Interest Rate vs Loan Status", plotOutput("interest_rate_plot")),
        tabPanel("Loan Purpose", plotOutput("loan_purpose_plot"))
      )
    )
  )
)

server <- function(input, output) {
  
  filtered_data <- reactive({
    loan_data %>%
      filter(person_age >= input$age_range[1] & person_age <= input$age_range[2])
  })
  
  output$loan_status_plot <- renderPlot({
    ggplot(filtered_data(), aes(x = factor(loan_status), fill = factor(loan_status))) +
      geom_bar() +
      labs(title = "Loan Status Distribution", x = "Loan Status", y = "Count")
  })
  
  output$income_loan_plot <- renderPlot({
    ggplot(filtered_data(), aes(x = person_income, y = loan_amnt)) +
      geom_point(alpha = 0.5) +
      labs(title = "Income vs Loan Amount", x = "Income", y = "Loan Amount")
  })
  
  output$loan_amount_distribution <- renderPlot({
    ggplot(filtered_data(), aes(x = loan_amnt)) +
      geom_histogram(binwidth = 5000, fill = "blue") +
      labs(title = "Loan Amount Distribution", x = "Loan Amount", y = "Count")
  })
  
  
  
  
  output$interest_rate_plot <- renderPlot({
    ggplot(filtered_data(), aes(x = factor(loan_status), y = loan_int_rate)) +
      geom_boxplot() +
      labs(title = "Interest Rate vs Loan Status", x = "Loan Status", y = "Interest Rate")
  })
  
  output$loan_purpose_plot <- renderPlot({
    ggplot(filtered_data(), aes(x = loan_intent, fill = loan_intent)) +
      geom_bar() +
      labs(title = "Loan Purpose Distribution", x = "Loan Purpose", y = "Count")
  })
}

shinyApp(ui = ui, server = server)



